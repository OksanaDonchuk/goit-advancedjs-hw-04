{"version":3,"file":"commonHelpers.js","sources":["../src/js/get-img.js","../src/js/loader-more.js","../src/js/loader.js","../src/js/sticky.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '37918988-e3d1c8b61b1090de1ebde83c0';\n\nexport default class PostsApiService {\n  constructor() {\n    this.searchQuery = '';\n    this.page = 1;\n    this.totalHits = 0;\n  }\n\n  async fetchPost() {\n    const OPTIONS = new URLSearchParams({\n      key: API_KEY,\n      q: this.searchQuery,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page: this.page,\n      per_page: 40,\n    });\n\n    try {\n      const response = await axios.get(`${BASE_URL}?${OPTIONS.toString()}`);\n      this.incrementPage();\n      return response.data;\n    } catch (error) {\n      console.error(error.toJSON());\n    }\n  }\n\n  get query() {\n    return this.searchQuery;\n  }\n\n  set query(newQuery) {\n    this.searchQuery = newQuery;\n  }\n\n  get hits() {\n    return this.totalHits;\n  }\n\n  set hits(newTotalHits) {\n    this.totalHits = newTotalHits;\n  }\n\n  incrementPage() {\n    this.page += 1;\n  }\n\n  resetPage() {\n    this.page = 1;\n  }\n}\n","export default class LoadMoreBtn {\n  constructor({ selector, hidden = false }) {\n    this.refs = this.getRefs(selector);\n    hidden && this.hide();\n  }\n\n  getRefs(selector) {\n    const refs = {};\n\n    refs.button = document.querySelector(selector);\n\n    return refs;\n  }\n\n  enable() {\n    this.refs.button.disable = false;\n    this.refs.button.classList.remove('btn-loading');\n  }\n\n  disable() {\n    this.refs.button.disable = true;\n    this.refs.button.classList.add('btn-loading');\n  }\n\n  show() {\n    this.refs.button.classList.remove('is-hidden');\n  }\n\n  hide() {\n    this.refs.button.classList.add('is-hidden');\n  }\n}\n","export default class PageLoadStatus {\n  constructor({ selector, hidden = false }) {\n    this.refs = this.getRefs(selector);\n    hidden && this.hide();\n  }\n\n  getRefs(selector) {\n    const refs = {};\n\n    refs.pageLoadStatus = document.querySelector(selector);\n    refs.ellips = document.querySelector('.loader-ellips');\n    refs.infScrollLast = document.querySelector('.infinite-scroll-last');\n    refs.infScrollError = document.querySelector('.infinite-scroll-error');\n\n    return refs;\n  }\n\n  show() {\n    this.refs.pageLoadStatus.classList.remove('is-hidden');\n  }\n\n  hide() {\n    this.refs.pageLoadStatus.classList.add('is-hidden');\n  }\n\n  enable() {\n    this.refs.ellips.classList.add('is-hidden');\n    this.refs.infScrollLast.classList.add('is-hidden');\n    this.refs.infScrollError.classList.add('is-hidden');\n  }\n\n  loadingShow() {\n    this.refs.ellips.classList.remove('is-hidden');\n    this.refs.infScrollLast.classList.add('is-hidden');\n    this.refs.infScrollError.classList.add('is-hidden');\n  }\n\n  loadingHide() {\n    this.refs.ellips.classList.add('is-hidden');\n  }\n\n  lastElemShow() {\n    this.refs.infScrollLast.classList.remove('is-hidden');\n\n    this.refs.ellips.classList.add('is-hidden');\n    this.refs.infScrollError.classList.add('is-hidden');\n  }\n\n  lastElemHide() {\n    this.refs.infScrollLast.classList.add('is-hidden');\n  }\n\n  errorShow() {\n    this.refs.infScrollError.classList.remove('is-hidden');\n\n    this.refs.ellips.classList.add('is-hidden');\n    this.refs.infScrollLast.classList.add('is-hidden');\n  }\n\n  errorHide() {\n    this.refs.infScrollLast.classList.add('is-hidden');\n  }\n}\n","const formRef = document.querySelector('.search-form');\nconst galleryRef = document.querySelector('.gallery');\nconst sticky = formRef.offsetTop;\n\nexport default function formSticky() {\n  if (window.scrollY > sticky) {\n    formRef.classList.add('on-scroll');\n    galleryRef.style.paddingTop = `72px`;\n  } else {\n    formRef.classList.remove('on-scroll');\n    galleryRef.style.paddingTop = `24px`;\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport PostApiService from './js/get-img';\nimport LoadMoreBtn from './js/loader-more';\nimport PageLoadStatus from './js/loader';\nimport formSticky from './js/sticky';\n\nconst refs = {\n  formSearch: document.querySelector('.search-form'),\n  gallery: document.querySelector('.gallery'),\n};\n\nconst loadMoreBtn = new LoadMoreBtn({\n  selector: '.load-more',\n  hidden: true,\n});\n\nconst pageLoadStatus = new PageLoadStatus({\n  selector: '.page-load-status',\n});\n\nconst postApiService = new PostApiService();\nconst lightbox = new SimpleLightbox('.gallery__item', {\n  captionDelay: 250,\n  captionsData: 'alt',\n  enableKeyboard: true,\n});\nconst obsOptions = {\n  root: null,\n  rootMargin: '100px',\n  treshold: 1,\n};\nconst observer = new IntersectionObserver(onLoading, obsOptions);\n\nrefs.formSearch.addEventListener('submit', onSearch);\nloadMoreBtn.refs.button.addEventListener('click', onLoadMore);\nwindow.addEventListener('scroll', formSticky);\n\nfunction onSearch(e) {\n  e.preventDefault();\n  pageLoadStatus.hide();\n\n  postApiService.query = e.target.searchQuery.value.trim();\n  loadMoreBtn.show();\n  postApiService.resetPage();\n  clearGallery();\n  fetchPosts();\n}\n\nfunction onLoadMore() {\n  fetchPosts();\n\n  pageLoadStatus.show();\n  observer.observe(pageLoadStatus.refs.pageLoadStatus);\n}\n\nfunction fetchPosts() {\n  loadMoreBtn.hide();\n  pageLoadStatus.loadingShow();\n\n  postApiService.fetchPost().then(data => {\n    const curentPage = postApiService.page - 1;\n    postApiService.hits = data.totalHits;\n\n    if (!data.totalHits) {\n      loadMoreBtn.hide();\n      pageLoadStatus.errorShow();\n\n      return iziToast.show({\n        message:\n          'Sorry, there are no images matching your search query. Please try again.',\n        position: 'topRight',\n        color: '#FCE8E6',\n      });\n    }\n\n    if (!data.hits.length) {\n      loadMoreBtn.hide();\n      pageLoadStatus.lastElemShow();\n      return;\n    }\n    renderPost(data.hits);\n    if (curentPage === 1) {\n      iziToast.show({\n        message: `Hooray! We found ${postApiService.hits} images.`,\n        position: 'topRight',\n        color: '#E6FCED',\n      });\n      loadMoreBtn.show();\n    }\n    pageLoadStatus.enable();\n  });\n}\n// Create markup posts\nfunction renderPost(data) {\n  let markupPost = data\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<a class=\"gallery__item\" href=\"${largeImageURL}\">\n                  <div class=\"photo-card\">\n                      <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n                      <div class=\"info\">\n                        <p class=\"info-item\"><b>Likes</b> ${likes}</p>\n                        <p class=\"info-item\"><b>Views</b> ${views}</p>\n                        <p class=\"info-item\"><b>Comments</b> ${comments}</p>\n                        <p class=\"info-item\"><b>Downloads</b> ${downloads}</p>\n                      </div>\n                    </div>\n                 </a>`;\n      }\n    )\n    .join('');\n\n  refs.gallery.insertAdjacentHTML('beforeend', markupPost);\n  lightbox.refresh();\n  // smoothScroll();\n}\n\nfunction clearGallery() {\n  refs.gallery.innerHTML = '';\n}\n\nfunction smoothScroll() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nasync function onLoading(entries) {\n  await entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      console.log(entry.isIntersecting);\n      fetchPosts();\n    }\n  });\n}\n"],"names":["BASE_URL","API_KEY","PostsApiService","OPTIONS","response","axios","error","newQuery","newTotalHits","LoadMoreBtn","selector","hidden","refs","PageLoadStatus","formRef","galleryRef","sticky","formSticky","loadMoreBtn","pageLoadStatus","postApiService","PostApiService","lightbox","SimpleLightbox","obsOptions","observer","onLoading","onSearch","onLoadMore","e","clearGallery","fetchPosts","data","curentPage","iziToast","renderPost","markupPost","largeImageURL","webformatURL","tags","likes","views","comments","downloads","entries","entry"],"mappings":"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"}