{"version":3,"file":"commonHelpers.js","sources":["../src/js/get-img.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function fetchPost(query, pageNumber, resultsAmount) {\n  const BASE_URL = 'https://pixabay.com/api/';\n  const API_KEY = '37918988-e3d1c8b61b1090de1ebde83c0';\n\n  const resp = await axios.get(`${BASE_URL}`, {\n    params: {\n      key: `${API_KEY}`,\n      q: `${query}`,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      page: `${pageNumber}`,\n      per_page: `${resultsAmount}`,\n    },\n  });\n  return resp.data;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { fetchPost } from './js/get-img';\n\nconst RES_PER_PAGE = 40;\n\nconst formSearch = document.querySelector('.search-form');\nconst gallery = document.querySelector('.gallery');\nconst divObserver = document.querySelector('.observer');\nconst endPage = document.querySelector('.end-page');\n\nconst lightbox = new SimpleLightbox('.gallery a');\nconst observer = new IntersectionObserver(observerAction, {\n  rootMargin: '1000px',\n});\n\nendPage.classList.add('is-hidden');\n\nformSearch.addEventListener('submit', onSubmit);\n\nlet currentPage;\nlet currentQuery;\n\nfunction onSubmit(event) {\n  event.preventDefault();\n  const query = event.currentTarget.elements.searchQuery.value.trim();\n  if (!query) {\n    iziToast.show({\n      message: 'Enter the value to search for.',\n      position: 'topRight',\n      color: '#FCE8E6',\n    });\n    return;\n  }\n\n  currentPage = 0;\n  currentQuery = query;\n  gallery.innerHTML = '';\n  observer.observe(divObserver);\n}\n\nasync function observerAction(entries) {\n  entries.forEach(async entry => {\n    if (entry.isIntersecting) {\n      currentPage += 1;\n      const newMarkup = await createMarkup(currentQuery, currentPage);\n      if (newMarkup) {\n        gallery.insertAdjacentHTML('beforeend', newMarkup);\n        lightbox.refresh();\n      }\n    }\n  });\n}\n\nasync function createMarkup(query, pageNumber = 1) {\n  try {\n    endPage.classList.add('is-hidden');\n    const data = await fetchPost(query, pageNumber, RES_PER_PAGE);\n\n    if (!data.totalHits) {\n      iziToast.show({\n        message:\n          'Sorry, there are no images matching your search query. Please try again.',\n        position: 'topRight',\n        color: '#FCE8E6',\n      });\n      observer.disconnect();\n      return '';\n    }\n    if (pageNumber === 1) {\n      iziToast.show({\n        message: `Hooray! We found ${data.totalHits} images.`,\n        position: 'topRight',\n        color: '#E6FCED',\n      });\n    }\n    if (data.totalHits <= pageNumber * RES_PER_PAGE) {\n      observer.disconnect();\n      endPage.classList.remove('is-hidden');\n    }\n\n    return data.hits\n      .map(\n        ({\n          largeImageURL,\n          webformatURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        }) => {\n          return `\n                <a class=\"gallery__item\" href=\"${largeImageURL}\">\n                  <div class=\"photo-card\">\n                      <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n                      <div class=\"info\">\n                        <p class=\"info-item\"><b>Likes</b> ${likes}</p>\n                        <p class=\"info-item\"><b>Views</b> ${views}</p>\n                        <p class=\"info-item\"><b>Comments</b> ${comments}</p>\n                        <p class=\"info-item\"><b>Downloads</b> ${downloads}</p>\n                      </div>\n                    </div>\n                 </a>`;\n        }\n      )\n      .join('');\n  } catch (err) {\n    console.dir(err);\n    iziToast.error({ message: err.message });\n    observer.disconnect();\n  }\n}\n"],"names":["fetchPost","query","pageNumber","resultsAmount","BASE_URL","API_KEY","axios","RES_PER_PAGE","formSearch","gallery","divObserver","endPage","lightbox","SimpleLightbox","observer","observerAction","onSubmit","currentPage","currentQuery","event","iziToast","entries","entry","newMarkup","createMarkup","data","largeImageURL","webformatURL","tags","likes","views","comments","downloads","err"],"mappings":"owBAEO,eAAeA,EAAUC,EAAOC,EAAYC,EAAe,CAChE,MAAMC,EAAW,2BACXC,EAAU,qCAahB,OAXa,MAAMC,EAAM,IAAI,GAAGF,IAAY,CAC1C,OAAQ,CACN,IAAK,GAAGC,IACR,EAAG,GAAGJ,IACN,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,KAAM,GAAGC,IACT,SAAU,GAAGC,GACd,CACL,CAAG,GACW,IACd,CCZA,MAAMI,EAAe,GAEfC,EAAa,SAAS,cAAc,cAAc,EAClDC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAc,SAAS,cAAc,WAAW,EAChDC,EAAU,SAAS,cAAc,WAAW,EAE5CC,EAAW,IAAIC,EAAe,YAAY,EAC1CC,EAAW,IAAI,qBAAqBC,EAAgB,CACxD,WAAY,QACd,CAAC,EAEDJ,EAAQ,UAAU,IAAI,WAAW,EAEjCH,EAAW,iBAAiB,SAAUQ,CAAQ,EAE9C,IAAIC,EACAC,EAEJ,SAASF,EAASG,EAAO,CACvBA,EAAM,eAAc,EACpB,MAAMlB,EAAQkB,EAAM,cAAc,SAAS,YAAY,MAAM,OAC7D,GAAI,CAAClB,EAAO,CACVmB,EAAS,KAAK,CACZ,QAAS,iCACT,SAAU,WACV,MAAO,SACb,CAAK,EACD,MACD,CAEDH,EAAc,EACdC,EAAejB,EACfQ,EAAQ,UAAY,GACpBK,EAAS,QAAQJ,CAAW,CAC9B,CAEA,eAAeK,EAAeM,EAAS,CACrCA,EAAQ,QAAQ,MAAMC,GAAS,CAC7B,GAAIA,EAAM,eAAgB,CACxBL,GAAe,EACf,MAAMM,EAAY,MAAMC,EAAaN,EAAcD,CAAW,EAC1DM,IACFd,EAAQ,mBAAmB,YAAac,CAAS,EACjDX,EAAS,QAAO,EAEnB,CACL,CAAG,CACH,CAEA,eAAeY,EAAavB,EAAOC,EAAa,EAAG,CACjD,GAAI,CACFS,EAAQ,UAAU,IAAI,WAAW,EACjC,MAAMc,EAAO,MAAMzB,EAAUC,EAAOC,EAAYK,CAAY,EAE5D,OAAKkB,EAAK,WAUNvB,IAAe,GACjBkB,EAAS,KAAK,CACZ,QAAS,oBAAoBK,EAAK,oBAClC,SAAU,WACV,MAAO,SACf,CAAO,EAECA,EAAK,WAAavB,EAAaK,IACjCO,EAAS,WAAU,EACnBH,EAAQ,UAAU,OAAO,WAAW,GAG/Bc,EAAK,KACT,IACC,CAAC,CACC,cAAAC,EACA,aAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACV,IACiB;AAAA,iDACgCN;AAAA;AAAA,kCAEfC,WAAsBC;AAAA;AAAA,4DAEIC;AAAA,4DACAC;AAAA,+DACGC;AAAA,gEACCC;AAAA;AAAA;AAAA,sBAKzD,EACA,KAAK,EAAE,IA9CRZ,EAAS,KAAK,CACZ,QACE,2EACF,SAAU,WACV,MAAO,SACf,CAAO,EACDN,EAAS,WAAU,EACZ,GAwCV,OAAQmB,EAAP,CACA,QAAQ,IAAIA,CAAG,EACfb,EAAS,MAAM,CAAE,QAASa,EAAI,OAAS,CAAA,EACvCnB,EAAS,WAAU,CACpB,CACH"}